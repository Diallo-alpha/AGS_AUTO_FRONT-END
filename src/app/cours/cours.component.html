<!-- <app-nav-connect></app-nav-connect> -->

<div class="page-container">
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="sidebar-header">
      <a href="#"><i class="fas fa-home"></i></a>
    </div>
    <div class="sidebar-content">
      <h5 class="mb-3">{{ formation?.nom_formation }}</h5>

      <!-- Progression display -->
      <div class="mb-4">
        <p class="mb-1 small">{{ progression | number:'1.0-0' }}% TERMINÉ</p>
        <div class="progress">
          <div class="progress-bar bg-success" role="progressbar"
               [style.width.%]="progression"
               [attr.aria-valuenow]="progression"
               aria-valuemin="0"
               aria-valuemax="100">
          </div>
        </div>
      </div>

      <h6 class="mb-2">Contenu du cours</h6>
      <ul class="list-group mb-4">
        <li *ngFor="let video of videos; let i = index"
            class="list-group-item"
            [class.active-item]="video === currentVideo"
            (click)="selectVideo(video)">
          <i [class]="video === currentVideo ? 'far fa-play-circle text-info' : 'far fa-circle'"></i>
          <span>{{ video.titre }}</span>
          <i *ngIf="isVideoWatched(video.id)" class="fas fa-check text-success ml-2"></i>
        </li>
      </ul>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <div class="video-section">
      <div class="video-container mb-3">
        <video *ngIf="safeVideoUrl" [src]="safeVideoUrl" controls width="100%" (ended)="onVideoEnded()"></video>
        <i *ngIf="!safeVideoUrl" class="fas fa-play-circle play-button"></i>
      </div>
      <h3>{{ currentVideo?.titre }}</h3>
    </div>

    <div class="resources-section">
      <h6 class="resource-title">RESSOURCES DE LA VIDÉO</h6>
      <div *ngFor="let resource of currentResources" class="mb-2">
        <a class="download-link" [href]="resource.documents" target="_blank">
          {{ resource.titre }} <i class="fas fa-download download-icon"></i>
        </a>
      </div>
      <div *ngIf="currentResources.length === 0">
        Aucune ressource disponible pour cette vidéo.
      </div>
    </div>
  </div>
</div>

<!-- <app-footer></app-footer> -->
